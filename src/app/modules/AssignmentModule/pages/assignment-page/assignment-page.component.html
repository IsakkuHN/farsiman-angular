<p-toast></p-toast>
<p-dialog header="Formulario de Trayecto" [(visible)]="visible" [style]="{width: '50vw', height: '50vh'}"
  [modal]="true">
  <form [formGroup]="assigmentForm" (ngSubmit)="onSubmit()">
    <div class="form-container">
      <span>
        <label for="">Sucursal</label>
        <p-dropdown formControlName="branch" [options]="branches" [(ngModel)]="selectedBranch" optionLabel="name"
          [filter]="true" filterBy="name" [showClear]="true" placeholder="Selectciona la Sucursal">
          <ng-template pTemplate="selectedItem" let-selectedOption>
            <div class="flex align-items-center gap-2">
              <div>{{ selectedOption.name + ' - ' + selectedOption.address}}</div>
            </div>
          </ng-template>
        </p-dropdown>
      </span>
      <span>
        <label for="">Colaborador</label>
        <p-dropdown formControlName="collaborator" [options]="collaborators" [(ngModel)]="selectedCollaborator"
          optionLabel="id" [filter]="true" filterBy="name" [showClear]="true" placeholder="Selecciona el Colaborador">
          <ng-template pTemplate="selectedItem" let-selectedOption>
            <div class="flex align-items-center gap-2">
              <div>{{ selectedOption.id.substring(0,8) +' - '+ selectedOption.firstName + ' '+ selectedOption.lastName
                }}
              </div>
            </div>
          </ng-template>
        </p-dropdown>
      </span>
      <span>
        <label for="">Distancia</label>
        <p-inputNumber formControlName="distance" inputId="locale-us" mode="decimal" locale="en-US"
          [minFractionDigits]="2" [max]="50" [min]="1">
        </p-inputNumber>
      </span>

    </div>
    <p-button label="Guardar trayecto" type="submit"></p-button>
  </form>
</p-dialog>
<div class="card">
  <div class="flex align-items-center justify-content-between my-4">
    <h1>Tabla de Trayectos</h1>
    <p-button label="Agregar Trayecto de Colaborador" icon="pi pi-plus" rounded="true"
      (onClick)="showDialog()"></p-button>
  </div>

  <p-table [value]="assignments" [tableStyle]="{ 'min-width': '50rem' }">
    <ng-template pTemplate="header">
      <tr>
        <th>Codigo de Colaborador</th>
        <th>Nombre de Colaborador</th>
        <th>Sucursal Asignada</th>
        <th>Distancia</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-assigment>
      <tr>
        <td>{{ assigment.collaborator.id }}</td>
        <td>{{ assigment.collaborator.firstName + ' ' + assigment.collaborator.lastName}}</td>
        <td>{{ assigment.branch.name + ' '+ assigment.branch.address}}</td>
        <td>{{ assigment.distance }} km</td>
      </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4">No existen trayecto de colaboradores registrados</td>
      </tr>
    </ng-template>
  </p-table>
</div>